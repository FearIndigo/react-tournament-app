var Pe=Object.defineProperty;var Ae=(s,t,n)=>t in s?Pe(s,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):s[t]=n;var G=(s,t,n)=>(Ae(s,typeof t!="symbol"?t+"":t,n),n);import{a as Y,w as Ie,g as De,c as Be,R as Ee,b as Fe,d as Le,j as e,r as d,v,C as se,e as j,P as Ge,f as qe,M as Ve,h as Ke,I as Je,X as He,T as We,i as _e,k as ze}from"./vendor-yfEVOQtO.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))a(r);new MutationObserver(r=>{for(const l of r)if(l.type==="childList")for(const c of l.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&a(c)}).observe(document,{childList:!0,subtree:!0});function n(r){const l={};return r.integrity&&(l.integrity=r.integrity),r.referrerPolicy&&(l.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?l.credentials="include":r.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function a(r){if(r.ep)return;r.ep=!0;const l=n(r);fetch(r.href,l)}})();const Xe="bracketDocType",Ue=0,Ze=!0,Qe="id",Ye="object",es={id:{type:"string",maxLength:100},name:{type:"string",default:""},type:{type:"string",enum:["elimination","doubleElimination","roundRobin","finals","custom"],default:"elimination"},rounds:{ref:"rounds",type:"array",uniqueItems:!0,items:{type:"string"},default:[]},createdAt:{type:"string",maxLength:100,default:"",final:!0},updatedAt:{type:"string",default:""}},ss=["id","name","type","rounds"],ts=["createdAt"],ns={title:Xe,version:Ue,keyCompression:Ze,primaryKey:Qe,type:Ye,properties:es,required:ss,indexes:ts},as="gameDocType",rs=0,ls=!0,cs="id",os="object",is={id:{type:"string",maxLength:100},name:{type:"string",default:""},type:{type:"string",enum:["highestScore","lowestScore"],default:"highestScore"},completed:{type:"boolean",default:!1},scores:{ref:"scores",type:"array",uniqueItems:!0,items:{type:"string"},default:[]},createdAt:{type:"string",maxLength:100,default:"",final:!0},updatedAt:{type:"string",default:""}},ds=["id","name","type","completed","scores"],us=["createdAt"],ms={title:as,version:rs,keyCompression:ls,primaryKey:cs,type:os,properties:is,required:ds,indexes:us},fs="memberDocType",xs=0,hs=!0,ps="id",js="object",gs={id:{type:"string",maxLength:100},name:{type:"string",default:""},createdAt:{type:"string",maxLength:100,default:"",final:!0},updatedAt:{type:"string",default:""}},Ns=["id","name"],bs=["createdAt"],ys={title:fs,version:xs,keyCompression:hs,primaryKey:ps,type:js,properties:gs,required:Ns,indexes:bs},vs="roundDocType",ws=0,Cs=!0,Ts="id",ks="object",Rs={id:{type:"string",maxLength:100},name:{type:"string",default:""},games:{ref:"games",type:"array",uniqueItems:!0,items:{type:"string"},default:[]},createdAt:{type:"string",maxLength:100,default:"",final:!0},updatedAt:{type:"string",default:""}},$s=["id","name","games"],Ss=["createdAt"],Os={title:vs,version:ws,keyCompression:Cs,primaryKey:Ts,type:ks,properties:Rs,required:$s,indexes:Ss},Ms="scoreDocType",Ps=0,As=!0,Is="id",Ds="object",Bs={id:{type:"string",maxLength:100},score:{type:"integer",default:0},team:{ref:"teams",type:"string"},createdAt:{type:"string",maxLength:100,default:"",final:!0},updatedAt:{type:"string",default:""}},Es=["id","score","team"],Fs=["createdAt"],Ls={title:Ms,version:Ps,keyCompression:As,primaryKey:Is,type:Ds,properties:Bs,required:Es,indexes:Fs},Gs="teamDocType",qs=0,Vs=!0,Ks="id",Js="object",Hs={id:{type:"string",maxLength:100},name:{type:"string",default:""},members:{ref:"members",type:"array",uniqueItems:!0,items:{type:"string"},default:[]},createdAt:{type:"string",maxLength:100,default:"",final:!0},updatedAt:{type:"string",default:""}},Ws=["id","name","members"],_s=["createdAt"],zs={title:Gs,version:qs,keyCompression:Vs,primaryKey:Ks,type:Js,properties:Hs,required:Ws,indexes:_s},Xs="tournamentDocType",Us=0,Zs=!0,Qs="id",Ys="object",et={id:{type:"string",maxLength:100},name:{type:"string",default:""},brackets:{ref:"brackets",type:"array",uniqueItems:!0,items:{type:"string"},default:[]},createdAt:{type:"string",maxLength:100,default:"",final:!0},updatedAt:{type:"string",default:""}},st=["id","name","brackets"],tt=["createdAt"],nt={title:Xs,version:Us,keyCompression:Zs,primaryKey:Qs,type:Ys,properties:et,required:st,indexes:tt};function at(s){s.preInsert(t=>{const n=new Date().toISOString();t.createdAt=n,t.updatedAt=n},!1),s.preSave(t=>{t.updatedAt=new Date().toISOString()},!1)}function rt(s){Object.values(s).forEach(t=>at(t)),s.tournaments.postRemove(t=>s.brackets.bulkRemove(t.brackets),!1),s.brackets.preRemove(t=>s.tournaments.find({selector:{brackets:t.id}}).exec().then(n=>{for(const a of n)a.incrementalModify(r=>(r.brackets=r.brackets.filter(l=>l!=t.id),r))}),!1),s.brackets.postRemove(t=>s.rounds.bulkRemove(t.rounds),!1),s.rounds.preRemove(t=>s.brackets.find({selector:{rounds:t.id}}).exec().then(n=>{for(const a of n)a.incrementalModify(r=>(r.rounds=r.rounds.filter(l=>l!=t.id),r))}),!1),s.rounds.postRemove(t=>s.games.bulkRemove(t.games),!1),s.games.preRemove(t=>s.rounds.find({selector:{games:t.id}}).exec().then(n=>{for(const a of n)a.incrementalModify(r=>(r.games=r.games.filter(l=>l!=t.id),r))}),!1),s.games.postRemove(t=>s.scores.bulkRemove(t.scores),!1),s.scores.preRemove(t=>s.games.find({selector:{scores:t.id}}).exec().then(n=>{for(const a of n)a.incrementalModify(r=>(r.scores=r.scores.filter(l=>l!=t.id),r))}),!1),s.members.preRemove(t=>s.teams.find({selector:{members:t.id}}).exec().then(n=>{for(const a of n)a.incrementalModify(r=>(r.members=r.members.filter(l=>l!=t.id),r))}),!1),s.teams.preRemove(t=>s.scores.find({selector:{team:t.id}}).exec().then(async n=>{for(const a of n)await a.incrementalRemove()}),!1)}async function lt(){Y(Ee),Y(Fe);const s=Ie({storage:De()}),t=await Be({name:"react-tournament-app",storage:s,eventReduce:!0}),n=ns,a=ms,r=ys,l=Os,c=Ls,o=zs,u=nt,i=await t.addCollections({brackets:{schema:n},games:{schema:a},members:{schema:r},rounds:{schema:l},scores:{schema:c},teams:{schema:o},tournaments:{schema:u}});return rt(i),t}te.defaultProps={className:""};function te({className:s}){const{rive:t,RiveComponent:n}=Le.useRive({src:"/trophy.riv",autoplay:!0});function a(){t&&(t.stop("wobble"),t.play("wobble"))}return e.jsx(n,{onClick:a,className:`tap-none cursor-pointer select-none ${s}`})}function ct({tabs:s,defaultTabIndex:t,onChanged:n,className:a}){const[r,l]=d.useState(t??0);function c(o){l(o),n(o)}return e.jsx("div",{className:`bg-300 rounded-full p-1 text-violet-800 ${a}`,children:e.jsxs("div",{className:"relative grid h-10",style:{gridTemplateColumns:`repeat(${s.length},1fr)`},children:[e.jsx("span",{className:"bg-100 absolute left-0 top-0 h-full rounded-full shadow transition-transform",style:{transform:`translateX(${r*100}%)`,width:`${1/s.length*100}%`}}),s.map((o,u)=>e.jsxs("div",{className:"relative truncate",children:[e.jsx("input",{type:"radio",id:`tab-button-${u}`,name:"tab-buttons",onChange:()=>c(u),className:"hidden"}),e.jsx("label",{htmlFor:`tab-button-${u}`,className:`tap-none flex h-full w-full cursor-pointer items-center justify-center truncate px-3 text-center font-bold leading-none ${u==r,""}`,children:o})]},u))]})})}S.defaultProps={inputMode:"text",className:""};function S({value:s,inputMode:t,placeholder:n,label:a,disabled:r,className:l,onChange:c}){function o(i){c(i.target.value)}const u=d.useMemo(()=>v(),[]);return e.jsxs(e.Fragment,{children:[a&&e.jsx("label",{htmlFor:u,className:"mx-2",children:a}),e.jsx("div",{className:`rounded-3xl shadow ${l}`,children:r?e.jsx("span",{className:"bg-300 input",children:s}):e.jsx("input",{id:u,type:"text",inputMode:t,value:s,placeholder:n,onChange:o,className:"bg-100 input"})})]})}function p(s){return e.jsx(e.Fragment,{children:s.children})}function ne(s){return d.useMemo(()=>d.Children.toArray(s).reduce((t,n)=>{const a=n;return a.type==p&&(a.props.name!=""?t[a.props.name]=n:t.default=e.jsxs(e.Fragment,{children:[t.default,a]})),t},{default:null}),[s])}function w(s){const[t,n]=d.useState(s),[a,r]=d.useState(s);return a!=s&&(r(s),t!=s&&n(s)),[t,n]}M.defaultProps={inputMode:"numeric",className:""};function M({value:s,inputMode:t,min:n,max:a,step:r,placeholder:l,label:c,disabled:o,className:u,onChange:i,onKeyDown:x,onBlur:m,focused:f}){const h=d.useRef(null),[b,N]=w(s.toString());d.useEffect(()=>{var $;f&&(($=h.current)==null||$.focus())},[f,h]);const k=d.useMemo(()=>v(),[]);function L($){const O=r??1;return Math.min(a??1/0,Math.max(n??-1/0,Math.round(parseFloat($)/O)*O))}function Oe($){const O=L($.target.value);isNaN(O)?N($.target.value):(N(O.toString()),i(O))}function Me($){if(isNaN(parseFloat($.target.value))){const O=L("0");N(O.toString()),i(O)}m&&m($)}return e.jsxs(e.Fragment,{children:[c&&e.jsx("label",{htmlFor:k,className:"mx-2",children:c}),e.jsx("div",{className:`rounded-3xl shadow ${u}`,children:o?e.jsx("span",{className:"bg-300 input",children:s}):e.jsx("input",{id:k,ref:h,type:"number",inputMode:t,value:b,placeholder:l,onChange:Oe,className:"bg-100 input",min:n,max:a,step:r,onKeyDown:x,onBlur:Me})})]})}y.defaultProps={className:""};function y({className:s,children:t}){const n=ne(t);return e.jsx("div",{className:"w-full",children:e.jsxs("div",{className:`bg-100 mx-2 flex h-full flex-col rounded-3xl text-violet-800 ${s}`,children:[e.jsx("div",{className:"bg-300 -mx-2 flex h-10 items-center rounded-3xl",children:n.header}),n.content]})})}var B=(s=>(s.HighestScore="highestScore",s.LowestScore="lowestScore",s))(B||{}),g=(s=>(s.Elimination="elimination",s.DoubleElimination="doubleElimination",s.RoundRobin="roundRobin",s.Finals="finals",s.Custom="custom",s))(g||{});const ae={numTeams:2,numGames:1},re={type:g.Elimination,teamsIn:2,teamsOut:1,numRounds:1,rounds:[J(ae)]},ot={name:"New Tournament",numTeams:2,numBrackets:1,brackets:[J(re)]};function J(s){return JSON.parse(JSON.stringify(s))}function V(s,t){if(s>t.numBrackets-1)return;const n=s==0?t.numTeams:t.brackets[s-1].teamsOut,a=t.brackets[s];a.teamsIn=n,n<a.teamsOut&&(a.teamsOut=n,V(s+1,t)),K(s,t)}function K(s,t){const n=t.brackets[s];switch(n.type){default:case g.Elimination:n.numRounds=Math.ceil(Math.log2(n.teamsIn)-Math.log2(n.teamsOut));break;case g.DoubleElimination:break;case g.RoundRobin:n.numRounds=2*Math.ceil(n.teamsIn/2)-1;break;case g.Finals:break;case g.Custom:break}le(s,t)}function le(s,t){const n=t.brackets[s];switch(n.rounds.length=n.numRounds,n.rounds.fill(J(ae)),n.type){default:case g.Elimination:for(let a=0;a<n.numRounds;a++){const r=a==0?n.teamsIn:n.rounds[a-1].numGames+n.rounds[a-1].numTeams%2;n.rounds[a]={numTeams:r,numGames:Math.floor(r/2)}}break;case g.DoubleElimination:break;case g.RoundRobin:n.rounds.fill({numTeams:n.teamsIn,numGames:Math.floor(n.teamsIn/2)});break;case g.Finals:break;case g.Custom:break}}T.defaultProps={title:"Toggle accordion open"};function T({open:s,title:t,onChange:n}){return e.jsx("button",{title:t,className:"bg-100 h-8 w-8 rounded-3xl p-2 text-violet-800 shadow",onClick:()=>n(!s),children:e.jsx(se,{className:`transition-all duration-300 ease-in-out ${s?"rotate-180":"rotate-0"}`})})}A.defaultProps={className:""};function A({open:s,className:t,children:n}){return e.jsx("div",{className:`grid transition-[grid-template-rows_opacity] duration-300 ease-in-out ${s?"grid-rows-[1fr] opacity-100":"grid-rows-[0fr] opacity-0"} ${t}`,children:e.jsx("div",{className:"overflow-hidden",children:n})})}function it({data:s,onChange:t}){const[n,a]=d.useState(!0);function r(o){s.name=o,t(s)}function l(o){s.numTeams=o,V(0,s),t(s)}function c(o){if(s.numBrackets=o,o!=s.brackets.length){const u=s.brackets.length;s.brackets.length=o,o>u&&(s.brackets.fill({...re},u),V(u,s),K(u,s))}t(s)}return e.jsxs(y,{children:[e.jsx(p,{name:"header",children:e.jsxs("div",{className:"flex w-full items-center justify-between p-1",children:[e.jsx("span",{className:"px-2 font-bold",children:"Tournament"}),e.jsx(T,{onChange:a,open:n})]})}),e.jsx(p,{name:"content",children:e.jsx(A,{open:n,children:e.jsxs("div",{className:"flex w-full flex-col space-y-2 p-3 pt-2",children:[e.jsx("div",{children:e.jsx(S,{onChange:r,value:s.name,label:"Name"})}),e.jsx("div",{children:e.jsx(M,{onChange:l,value:s.numTeams,label:"Number of Teams",min:2})}),e.jsx("div",{children:e.jsx(M,{onChange:c,value:s.numBrackets,label:"Number of Brackets",min:1})})]})})})]})}function F(s){return s.replace(/([A-Z])/g,t=>` ${t}`).replace(/^./,t=>t.toUpperCase()).trim()}E.defaultProps={placeholder:"Choose Option:",title:"Select option",className:""};function E({value:s,options:t,placeholder:n,label:a,name:r,title:l,className:c,onChange:o}){function u(x){o(t[x.target.selectedIndex-1])}const i=d.useMemo(()=>v(),[]);return e.jsxs(e.Fragment,{children:[e.jsx("label",{htmlFor:i,className:`mx-2 ${!a&&"hidden"}`,children:a||l}),e.jsx("div",{className:`rounded-3xl shadow ${c}`,children:e.jsxs("div",{className:"relative w-full",children:[e.jsxs("select",{id:i,value:s,className:"bg-100 input relative pr-8",onChange:u,name:r,title:l,children:[e.jsx("option",{value:"",label:n,disabled:!0,children:n}),t.map((x,m)=>e.jsx("option",{value:x[0],label:x[1],children:x[1]},`${m}-${x[0]}`))]}),e.jsx(se,{className:"pointer-events-none absolute right-2 top-2 h-4 w-4"})]})})]})}function dt({data:s,index:t,onChange:n}){const[a,r]=d.useState(!1);function l(i){s.rounds[t].numTeams=i,n(s)}function c(i){s.rounds[t].numGames=i,n(s)}const o=d.useCallback(i=>i.type!=g.Custom,[]),u=d.useMemo(()=>s.rounds[t],[s,t]);return e.jsxs(y,{children:[e.jsx(p,{name:"header",children:e.jsxs("div",{className:"flex w-full items-center justify-between p-1",children:[e.jsx("span",{className:"px-2 font-bold",children:`Round ${t+1}`}),e.jsx(T,{onChange:r,open:a})]})}),e.jsx(p,{name:"content",children:e.jsx(A,{open:a,children:e.jsxs("div",{className:"flex flex-col space-y-2 p-3 pt-2",children:[e.jsx("div",{children:e.jsx(M,{onChange:l,value:u.numTeams,label:"Teams in Round",min:0,max:s.teamsIn,disabled:o(s)})}),e.jsx("div",{children:e.jsx(M,{onChange:c,value:u.numGames,label:"Games in Round",min:0,disabled:o(s)})})]})})})]})}function ut({data:s,index:t,onChange:n}){const[a,r]=d.useState(!1);function l(f){const h=f[0];Object.values(g).includes(h)&&(s.brackets[t].type=h,K(t,s),n(s))}function c(f){s.brackets[t].teamsOut=f,V(t+1,s),K(t,s),n(s)}function o(f){s.brackets[t].numRounds=f,le(t,s),n(s)}function u(f){s.brackets[t].rounds=f.rounds,n(s)}const i=d.useCallback(f=>f.type!=g.Custom,[]),x=d.useMemo(()=>Object.values(g).map(f=>[f,F(f)]),[]),m=d.useMemo(()=>s.brackets[t],[s,t]);return e.jsxs(y,{children:[e.jsx(p,{name:"header",children:e.jsxs("div",{className:"flex w-full items-center justify-between p-1",children:[e.jsx("span",{className:"px-2 font-bold",children:`Bracket ${t+1}`}),e.jsx(T,{onChange:r,open:a})]})}),e.jsx(p,{name:"content",children:e.jsx(A,{open:a,children:e.jsxs("div",{className:"flex flex-col space-y-4 p-3 pt-2",children:[e.jsxs("div",{className:"flex flex-col space-y-2",children:[e.jsx("div",{children:e.jsx(E,{onChange:l,options:x,value:m.type,label:"Bracket Type"})}),e.jsx("div",{children:e.jsx(M,{onChange:()=>{},value:m.teamsIn,disabled:!0,label:"Teams In"})}),e.jsx("div",{children:e.jsx(M,{onChange:c,value:m.teamsOut,label:"Teams Out",min:1,max:m.teamsIn})}),e.jsx("div",{children:e.jsx(M,{onChange:o,value:m.numRounds,label:"Number of Rounds",min:0,disabled:i(m)})})]}),m.rounds.length>0&&e.jsx("div",{className:"mt-4 flex w-full flex-col space-y-2",children:m.rounds.map((f,h)=>e.jsx(dt,{data:m,index:h,onChange:u},h))})]})})})]})}function mt({data:s,onChange:t}){function n(a){t(a)}return e.jsx(e.Fragment,{children:s.brackets.map((a,r)=>e.jsx(ut,{data:s,index:r,onChange:n},r))})}function ft({data:s}){const t=j.useRxCollection("tournaments"),n=j.useRxCollection("brackets"),a=j.useRxCollection("rounds"),r=j.useRxCollection("games");async function l(){!t||!n||!a||!r||(console.log(v()),console.log(s))}return e.jsx("div",{className:"flex justify-center text-violet-800",children:e.jsx("button",{className:"button bg-100 font-bold",onClick:l,children:"Create Tournament!"})})}function xt(){const[s,t]=d.useState(ot);function n(a){t(J(a))}return e.jsxs("div",{className:"flex w-full flex-col space-y-4 md:w-96",children:[e.jsx(it,{data:s,onChange:n}),e.jsx(mt,{data:s,onChange:n}),e.jsx(ft,{data:s})]})}I.defaultProps={title:"Toggle edit mode"};function I({editModeOff:s,title:t,onChange:n}){return e.jsxs("div",{className:"relative",children:[!s&&e.jsx("span",{className:"absolute left-1 top-1 h-6 w-6 animate-ping rounded-full bg-blue-400"}),e.jsx("button",{title:t,className:`relative z-10 h-8 w-8 rounded-3xl  p-2 shadow ${s?"bg-100 text-violet-800":"bg-blue-400 text-blue-800"}`,onClick:()=>n(!s),children:s?e.jsx(Ge,{}):e.jsx(qe,{})})]})}_.defaultProps={title:"Remove"};function _({title:s,onClick:t}){return e.jsx("button",{title:s,className:"h-8 w-8 rounded-3xl bg-red-300 p-2 text-red-800 shadow",onClick:t,children:e.jsx(Ve,{})})}ce.defaultProps={title:"Remove team member"};function ce({team:s,member:t,title:n}){function a(){s.incrementalPatch({members:s.members.filter(r=>r!=t.id)})}return e.jsx(_,{title:n,onClick:a})}P.defaultProps={title:"Remove document"};function P({document:s,title:t}){return e.jsx(_,{title:t,onClick:s.remove})}oe.defaultProps={className:""};function oe({member:s,className:t,readOnly:n,showEditButton:a,team:r}){const[l,c]=w(n??!0);function o(u){s.incrementalPatch({name:u})}return e.jsx(y,{className:`${t}`,children:e.jsx(p,{name:"header",children:e.jsxs("div",{className:"flex h-full w-full items-center space-x-1 p-1",children:[l?e.jsx("span",{className:"w-full truncate px-2",children:s.name}):e.jsx(S,{value:s.name,placeholder:"Name...",onChange:o,className:"w-full"}),(!l||a)&&e.jsxs("div",{className:"flex h-full flex-row items-center space-x-1",children:[!l&&(r?e.jsx(ce,{team:r,member:s}):e.jsx(P,{document:s,title:"Remove member"})),a&&e.jsx(I,{editModeOff:l,onChange:c,title:"Toggle member edit mode"})]})]})})})}z.defaultProps={className:""};function z({members:s,className:t,readOnly:n,team:a,showEditButton:r}){return e.jsx("div",{className:`flex flex-col space-y-1 ${t}`,children:s.map(l=>e.jsx(oe,{member:l,readOnly:n,showEditButton:r,team:a},l.id))})}ie.defaultProps={className:""};function ie({className:s}){return e.jsxs("svg",{className:s,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})}C.defaultProps={text:"loading...",className:""};function C({text:s,className:t}){return e.jsx("div",{children:e.jsxs("div",{className:`flex animate-pulse items-center space-x-1 ${t}`,children:[e.jsx("div",{className:"aspect-square h-full",children:e.jsx(ie,{className:"animate-spin"})}),e.jsx("span",{children:s})]})})}D.defaultProps={title:"Add new"};function D({title:s,onClick:t}){return e.jsx("button",{title:s,className:"h-8 w-8 rounded-3xl bg-green-300 p-2 text-green-800 shadow",onClick:t,children:e.jsx(Ke,{})})}function ht(){const s=j.useRxCollection("members");function t(){s==null||s.insert({id:v(),name:"New Member"})}return e.jsx(D,{title:"Add new member",onClick:t})}R.defaultProps={text:"info",className:""};function R({text:s,className:t}){return e.jsx("div",{children:e.jsxs("div",{className:`flex items-center space-x-1 ${t}`,children:[e.jsx("div",{className:"aspect-square h-full",children:e.jsx(Je,{})}),e.jsx("span",{children:s})]})})}function pt(){const[s,t]=d.useState(!0),{result:n,isFetching:a}=j.useRxData("members",r=>r.find({index:["createdAt"]}));return e.jsxs(y,{children:[e.jsx(p,{name:"header",children:e.jsxs("div",{className:"flex h-full w-full items-center justify-between p-1",children:[e.jsx("span",{className:"px-2 font-bold",children:"Members"}),e.jsxs("div",{className:"flex h-full flex-row items-center space-x-1",children:[e.jsx(I,{editModeOff:s,onChange:t,title:"Toggle edit mode all members"}),e.jsx(ht,{})]})]})}),e.jsx(p,{name:"content",children:e.jsx("div",{className:"p-3 pt-2",children:n.length>0?e.jsx(z,{members:n,showEditButton:!0,readOnly:s,className:"space-y-2"}):a?e.jsx(C,{className:"h-6"}):e.jsx(R,{text:"No members",className:"h-6"})})})]})}X.defaultProps={className:""};function X({value:s,options:t,placeholder:n,className:a,onChange:r}){const l=d.useCallback(i=>{let x=t.find(m=>m[0]==i);return x==null&&(x=t.find(m=>m[1]==i)),x||[i,i]},[t]);function c(i){r(l(i))}function o(i){t.includes(i)&&r(i)}const u=s[1]==""?t:t.filter(i=>i[1].toLowerCase().includes(s[1].toLowerCase()));return e.jsxs("div",{className:`relative flex h-8 w-full ${a}`,children:[e.jsx(E,{onChange:o,options:u,value:s[0],className:"absolute inset-0"}),e.jsx(S,{value:s[1],placeholder:n,onChange:c,className:"relative mr-7 w-full shadow-none"})]})}function jt({team:s}){const[t,n]=d.useState(["",""]),{result:a,isFetching:r}=j.useRxData("members",i=>i.find({index:["createdAt"]})),l=d.useMemo(()=>a.filter(i=>!s.members.includes(i.id)),[a,s]),c=d.useMemo(()=>l.map(i=>[i.id,i.name]),[l]),o=j.useRxCollection("members");if(r)return e.jsx(C,{className:"h-6"});async function u(){let i=t;if(i[0]==""){if(c.length==0)return;i=c[0]}let x=l.find(m=>m.id==i[0]);if(x==null&&(x=l.find(m=>m.name==i[1])),x==null){if(o==null)return;x=await o.insert({id:v(),name:i[1]})}s.incrementalPatch({members:[...s.members,x.id]}),n(["",""])}return e.jsxs("div",{className:"flex h-8 items-center space-x-1",children:[e.jsx(X,{onChange:n,placeholder:c.length>0?c[0][1]:"Member name...",options:c,value:t,className:"h-full w-full"}),e.jsx("div",{className:"flex h-full items-center",children:e.jsx(D,{title:"Add member to team",onClick:u})})]})}class de{constructor(){G(this,"wins");G(this,"loses");G(this,"draws");this.wins=0,this.loses=0,this.draws=0}points(){return this.wins*3+this.draws}gamesPlayed(){return this.wins+this.loses+this.draws}add(t){return this.wins+=t.wins,this.loses+=t.loses,this.draws+=t.draws,this}toString(){return`W: ${this.wins},
    L: ${this.loses},
    D: ${this.draws},
    P: ${this.gamesPlayed()},
    Pts: ${this.points()}`}}async function H(s){if(!s)return"";if(s.name!="")return s.name;const t=await s.populate("members");return t.length>0?t.map(n=>n.name).join(" + "):"New Team"}async function gt(s){if(!s||s.length==0)return{};const t={};for(const n of s)t[n.id]=await H(n);return t}async function Nt(s){if(!s)return"";if(s.name!="")return s.name;const t=await s.populate("scores"),n=[];for(const a of t){const r=await a.populate("team");r&&n.push(await H(r))}return n.length>0?n.join(" vs "):"New Game"}function bt(s){return s?s.name!=""?s.name:`${F(s.type)} Bracket`:""}function yt(s,t){if(!s)return"";if(s.name!="")return s.name;if(!t)return"New Round";const n=t.rounds.indexOf(s.id);return n!=-1?`Round ${n+1}`:"New Round"}async function vt(s){if(!s)return[];const t=await s.populate("scores");if(t.length==0)return[];const n={};for(const r of t)n[r.score]||(n[r.score]=[]),n[r.score].push(r.team);const a=t.map(r=>r.score);switch(s.type){default:case B.HighestScore:return n[a.sort((r,l)=>l-r)[0]];case B.LowestScore:return n[a.sort((r,l)=>r-l)[0]]}}async function ue(s){if(!s)return{};const t=await s.populate("scores");if(t.length==0)return{};const n=await vt(s),a={};for(const r of t){const l=new de;s.completed&&(n.includes(r.team)?n.length==1?l.wins=1:l.draws=1:l.loses=1),a[r.team]=l}return a}function wt(...s){const t={};for(const n of s)for(const a of Object.keys(n))t[a]||(t[a]=new de),t[a].add(n[a]);return t}function Ct(s){const[t,n]=d.useState(s.name);return d.useEffect(()=>{H(s).then(n)},[s]),t}function Tt(s){const[t,n]=d.useState(s.reduce((a,r)=>(a[r.id]=r.name,a),{}));return d.useEffect(()=>{gt(s).then(n)},[s]),t}function kt(s){const[t,n]=d.useState(s.name),[a]=W(s.scores),[r]=U(a.map(l=>l.team));return d.useEffect(()=>{Nt(s).then(n)},[s,r]),t}function Rt(s){const[t,n]=d.useState({}),[a]=W(s.scores);return d.useEffect(()=>{ue(s).then(n)},[s,a]),t}function $t(s){const[t,n]=d.useState({}),[a]=W(s.map(r=>r.scores).flat());return d.useEffect(()=>{async function r(){let l={};for(const c of s)l=wt(l,await ue(c));return l}r().then(n)},[s,a]),t}function me(s){const{result:t,isFetching:n}=j.useRxData("brackets",a=>a.find({selector:{id:{$in:s}},index:["createdAt"]}));return[t,n]}function fe(s){const{result:t,isFetching:n}=j.useRxData("rounds",a=>a.find({selector:{id:{$in:s}},index:["createdAt"]}));return[t,n]}function xe(s){const{result:t,isFetching:n}=j.useRxData("games",a=>a.find({selector:{id:{$in:s}},index:["createdAt"]}));return[t,n]}function W(s){const{result:t,isFetching:n}=j.useRxData("scores",a=>a.find({selector:{id:{$in:s}},index:["createdAt"]}));return[t,n]}function U(s){const{result:t,isFetching:n}=j.useRxData("teams",a=>a.find({selector:{id:{$in:s}},index:["createdAt"]}));return[t,n]}function St(s){const{result:t,isFetching:n}=j.useRxData("members",a=>a.find({selector:{id:{$in:s}},index:["createdAt"]}));return[t,n]}Z.defaultProps={className:""};function Z({team:s,showMembers:t,readOnly:n,className:a,showEditButton:r,children:l}){const c=ne(l),[o,u]=w(t??!1),[i,x]=w(n??!0),[m,f]=St(s.members),h=Ct(s);function b(N){s.incrementalPatch({name:N})}return e.jsxs(y,{className:`bg-100 ${a}`,children:[e.jsx(p,{name:"header",children:e.jsxs("div",{className:"flex h-full w-full items-center space-x-1 p-1",children:[i?e.jsxs(e.Fragment,{children:[c.preHeader&&e.jsx("div",{className:"h-full",children:c.preHeader}),e.jsx("span",{className:"w-full truncate px-2 font-bold",children:h})]}):e.jsx(S,{value:s.name,placeholder:h??"Name...",onChange:b,className:"w-full font-bold"}),e.jsxs("div",{className:"flex h-full space-x-1",children:[c.postHeader,!i&&e.jsx(P,{document:s,title:"Remove team"}),r&&e.jsx(I,{editModeOff:i,onChange:x,title:"Toggle team edit mode"}),e.jsx(T,{open:o,onChange:u,title:"Toggle show team members"})]})]})}),e.jsx(p,{name:"content",children:e.jsxs(A,{open:o,children:[e.jsx("div",{className:"p-2 pt-1",children:m.length>0?e.jsx(z,{members:m,readOnly:i,team:s}):f?e.jsx(C,{className:"h-6"}):e.jsx(R,{text:"No members",className:"h-6"})}),!i&&e.jsx("div",{className:"p-2 pt-0",children:e.jsx(jt,{team:s})})]})})]})}he.defaultProps={className:""};function he({teams:s,className:t,readOnly:n,showEditButton:a,showMembers:r}){return e.jsx("div",{className:`flex flex-col space-y-2 ${t}`,children:s.map(l=>e.jsx(Z,{team:l,readOnly:n,showEditButton:a,showMembers:r},l.id))})}function Ot(){const s=j.useRxCollection("teams");function t(){s==null||s.insert({id:v(),name:"",members:[]})}return e.jsx(D,{title:"Add new team",onClick:t})}function Mt(){const[s,t]=d.useState(!0),[n,a]=d.useState(!1),{result:r,isFetching:l}=j.useRxData("teams",c=>c.find({index:["createdAt"]}));return e.jsxs(y,{children:[e.jsx(p,{name:"header",children:e.jsxs("div",{className:"flex h-full w-full items-center justify-between p-1",children:[e.jsx("span",{className:"px-2 font-bold",children:"Teams"}),e.jsxs("div",{className:"flex h-full flex-row items-center space-x-1",children:[e.jsx(I,{editModeOff:s,onChange:t,title:"Toggle edit mode all teams"}),e.jsx(T,{open:n,onChange:a,title:"Toggle show all team members"}),e.jsx(Ot,{})]})]})}),e.jsx(p,{name:"content",children:e.jsx("div",{className:"p-3 pt-2",children:r.length>0?e.jsx(he,{teams:r,showEditButton:!0,showMembers:n,readOnly:s}):l?e.jsx(C,{className:"h-6"}):e.jsx(R,{text:"No teams",className:"h-6"})})})]})}function Pt({game:s,currentScores:t}){const[n,a]=d.useState(["",""]),[r,l]=d.useState([]),{result:c,isFetching:o}=j.useRxData("teams",f=>f.find({index:["createdAt"]})),u=d.useMemo(()=>c.filter(f=>!t.map(h=>h.team).includes(f.id)),[t,c]);d.useEffect(()=>{(async()=>{const h=[];for(const b of u){const N=await H(b);h.push([b.id,N])}return h})().then(l)},[u]);const i=j.useRxCollection("scores"),x=j.useRxCollection("teams");if(o)return e.jsx(C,{className:"h-6"});async function m(){let f=n;if(f[0]==""){if(r.length==0)return;f=r[0]}let h=u.find(N=>N.id==f[0]);if(h==null&&(h=u.find(N=>N.name==f[1])),h==null){if(x==null)return;h=await x.insert({id:v(),name:f[1],members:[]})}if(i==null)return;const b=await i.insert({id:v(),game:s.id,team:h.id,score:0});s.incrementalPatch({scores:[...s.scores,b.id]}),a(["",""])}return e.jsxs("div",{className:"flex h-8 items-center space-x-1",children:[e.jsx(X,{onChange:a,placeholder:r.length>0?r[0][1]:"Team name...",options:r,value:n,className:"h-full w-full"}),e.jsx("div",{className:"flex h-full items-center",children:e.jsx(D,{title:"Add team to game",onClick:m})})]})}pe.defaultProps={text:"error!",className:""};function pe({text:s,className:t}){return e.jsxs("div",{className:`flex animate-pulse items-center space-x-1 text-red-500 ${t}`,children:[e.jsx("div",{className:"aspect-square h-full  rounded-full bg-red-500 p-1",children:e.jsx(He,{className:"text-red-200"})}),e.jsx("span",{className:"truncate",children:s})]})}function At({score:s,game:t,readOnly:n,showRemoveButton:a}){var b;const[r,l]=w(n),c=(b=Rt(t)[s.team])==null?void 0:b.points(),[o,u]=U([s.team]),i=o[0];if(u)return e.jsx(C,{className:"h-6"});function x(){t.completed||l(!1)}function m(N){s.incrementalPatch({score:N})}function f(N){N.key=="Enter"&&h()}function h(){n&&l(!0)}return e.jsx("div",{className:"flex w-full items-center",children:e.jsx("div",{className:"w-full",children:i?e.jsxs(Z,{team:i,children:[e.jsx(p,{name:"preHeader",children:r?e.jsx("span",{onClick:x,className:`flex h-full w-12 items-center justify-center truncate rounded-3xl font-bold ${t.completed?"":"cursor-pointer shadow"} ${t.completed?c==3?"bg-green-300 text-green-800":c==1?"bg-sky-200 text-sky-800":"bg-red-200 text-red-800":"bg-100"}`,children:s.score}):e.jsx(M,{value:s.score,placeholder:"Score...",onChange:m,className:"w-16",onKeyDown:f,onBlur:h,focused:n})}),e.jsx(p,{name:"postHeader",children:!r&&a&&e.jsx(P,{title:"Remove team from game",document:s})})]}):e.jsxs("div",{className:"bg-300 flex h-10 items-center rounded-3xl p-1",children:[e.jsx(pe,{text:"missing team!",className:"h-full w-full"}),e.jsx(P,{title:"Remove team from game",document:s})]})})})}je.defaultProps={className:""};function je({scores:s,game:t,className:n,readOnly:a,showRemoveButton:r}){return e.jsx("div",{className:`flex flex-col space-y-1 ${n}`,children:s.map(l=>e.jsx(At,{score:l,game:t,readOnly:a,showRemoveButton:r},l.id))})}ge.defaultProps={title:"Toggle game completed"};function ge({completed:s,title:t,onChange:n}){return e.jsx("button",{title:t,className:`h-8 w-8 rounded-3xl p-2 shadow ${s?"bg-yellow-200 text-yellow-800":"bg-100 text-violet-800"}`,onClick:()=>n(!s),children:e.jsx(We,{})})}Ne.defaultProps={className:""};function Ne({game:s,readOnly:t,showEditButton:n,className:a,showScores:r}){const[l,c]=w(t??!0),[o,u]=w(r??!1),[i,x]=W(s.scores),m=kt(s);function f(k){s.incrementalPatch({name:k})}function h(k){const L=k[0];Object.values(B).includes(L)&&s.incrementalPatch({type:L})}function b(k){s.incrementalPatch({completed:k})}const N=d.useMemo(()=>Object.values(B).map(k=>[k,F(k)]),[]);return e.jsxs(y,{className:`bg-100 ${a}`,children:[e.jsx(p,{name:"header",children:e.jsxs("div",{className:"flex h-full w-full items-center space-x-1 p-1",children:[l?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"h-full",children:e.jsx(ge,{completed:s.completed,onChange:b})}),e.jsx("span",{className:"w-full truncate px-2 font-bold",children:m})]}):e.jsx(S,{value:s.name,placeholder:m??"Name...",onChange:f,className:"w-full font-bold"}),e.jsxs("div",{className:"flex h-full space-x-1",children:[!l&&e.jsx(P,{document:s,title:"Remove game"}),n&&e.jsx(I,{editModeOff:l,onChange:c,title:"Toggle game edit mode"}),e.jsx(T,{open:o,onChange:u,title:"Toggle show game teams"})]})]})}),e.jsx(p,{name:"content",children:e.jsxs(A,{open:o,children:[!l&&e.jsx("div",{className:"flex items-center p-2 py-1",children:e.jsx(E,{value:s.type,options:N,onChange:h,className:"w-full"})}),e.jsx("div",{className:"p-2 pt-1",children:i.length>0?e.jsx(je,{scores:i,readOnly:l,game:s,showRemoveButton:!l}):x?e.jsx(C,{className:"h-6"}):e.jsx(R,{text:"No teams",className:"h-6"})}),!l&&e.jsx("div",{className:"p-2 pt-0",children:e.jsx(Pt,{game:s,currentScores:i})})]})})]})}Q.defaultProps={className:""};function Q({games:s,className:t,readOnly:n,showEditButton:a,showScores:r}){return e.jsx("div",{className:`flex flex-col space-y-1 ${t}`,children:s.map(l=>e.jsx(Ne,{game:l,readOnly:n,showEditButton:a,showScores:r},l.id))})}function It(){const[s,t]=d.useState(!0),[n,a]=d.useState(!1),{result:r,isFetching:l}=j.useRxData("games",c=>c.find({index:["createdAt"]}));return e.jsxs(y,{children:[e.jsx(p,{name:"header",children:e.jsxs("div",{className:"flex h-full w-full items-center justify-between p-1",children:[e.jsx("span",{className:"px-2 font-bold",children:"Games"}),e.jsxs("div",{className:"flex h-full flex-row items-center space-x-1",children:[e.jsx(I,{editModeOff:s,onChange:t,title:"Toggle edit mode all games"}),e.jsx(T,{open:n,onChange:a,title:"Toggle show all game teams"})]})]})}),e.jsx(p,{name:"content",children:e.jsx("div",{className:"p-3 pt-2",children:r.length>0?e.jsx(Q,{games:r,showEditButton:!0,readOnly:s,showScores:n,className:"space-y-2"}):l?e.jsx(C,{className:"h-6"}):e.jsx(R,{text:"No games",className:"h-6"})})})]})}function Dt({bracket:s}){const[t,n]=d.useState(""),a=j.useRxCollection("rounds");async function r(){if(a==null)return;const l=await a.insert({id:v(),name:t,games:[]});s.incrementalPatch({rounds:[...s.rounds,l.id]})}return e.jsxs("div",{className:"flex h-8 items-center space-x-1",children:[e.jsx(S,{onChange:n,placeholder:`Round ${s.rounds.length+1}`,value:t,className:"h-full w-full"}),e.jsx("div",{className:"flex h-full items-center",children:e.jsx(D,{title:"Add round to bracket",onClick:r})})]})}function Bt({round:s}){const[t,n]=d.useState(B.HighestScore),a=j.useRxCollection("games");function r(o){const u=o[0];Object.values(B).includes(u)&&n(u)}async function l(){if(a==null)return;const o=await a.insert({id:v(),name:`Game ${s.games.length+1}`,type:t,completed:!1,scores:[]});s.incrementalPatch({games:[...s.games,o.id]})}const c=d.useMemo(()=>Object.values(B).map(o=>[o,F(o)]),[]);return e.jsxs("div",{className:"flex h-8  items-center space-x-1",children:[e.jsx(E,{onChange:r,options:c,value:t,className:"w-full"}),e.jsx("div",{className:"flex h-full items-center",children:e.jsx(D,{title:"Add game to round",onClick:l})})]})}be.defaultProps={className:""};function be({round:s,showGames:t,readOnly:n,className:a,bracket:r}){const[l]=w(n),[c,o]=w(t??!1),[u,i]=xe(s.games);function x(f){s.incrementalPatch({name:f})}const m=yt(s,r);return e.jsxs(y,{className:`bg-100 ${a}`,children:[e.jsx(p,{name:"header",children:e.jsxs("div",{className:"flex h-full w-full items-center space-x-1 p-1",children:[l?e.jsx("span",{className:"w-full truncate px-2 font-bold",children:m}):e.jsx(S,{value:s.name,placeholder:m??"Name...",onChange:x,className:"w-full font-bold"}),e.jsxs("div",{className:"flex h-full space-x-1",children:[!l&&e.jsx(P,{document:s,title:"Remove round"}),e.jsx(T,{open:c,onChange:o,title:"Toggle show round games"})]})]})}),e.jsx(p,{name:"content",children:e.jsxs(A,{open:c,children:[e.jsx("div",{className:"p-2 pt-1",children:u.length>0?e.jsx(Q,{games:u}):i?e.jsx(C,{className:"h-6"}):e.jsx(R,{text:"No games",className:"h-6"})}),!l&&e.jsx("div",{className:"self-end p-2 pt-0",children:e.jsx(Bt,{round:s})})]})})]})}ye.defaultProps={className:""};function ye({rounds:s,className:t,readOnly:n,bracket:a}){return e.jsx("div",{className:`flex flex-col space-y-1 ${t}`,children:s.map(r=>e.jsx(be,{round:r,bracket:a,readOnly:n},r.id))})}ve.defaultProps={className:""};function ve({bracket:s,showRounds:t,readOnly:n,className:a}){const[r]=w(n),[l,c]=w(t??!1),[o,u]=fe(s.rounds),i=bt(s);function x(h){s.incrementalPatch({name:h})}function m(h){const b=h[0];Object.values(g).includes(b)&&s.incrementalPatch({type:b})}const f=d.useMemo(()=>Object.values(g).map(h=>[h,F(h)]),[]);return e.jsxs(y,{className:`bg-100 ${a}`,children:[e.jsx(p,{name:"header",children:e.jsxs("div",{className:"flex h-full w-full items-center space-x-1 p-1",children:[r?e.jsx("span",{className:"w-full truncate px-2 font-bold",children:i}):e.jsx(S,{value:s.name,placeholder:i??"Name...",onChange:x,className:"w-full font-bold"}),e.jsxs("div",{className:"flex h-full space-x-1",children:[!r&&e.jsx(P,{document:s,title:"Remove bracket"}),e.jsx(T,{open:l,onChange:c,title:"Toggle show bracket rounds"})]})]})}),e.jsx(p,{name:"content",children:e.jsxs(A,{open:l,children:[!r&&e.jsx("div",{className:"flex items-center p-2 py-1",children:e.jsx(E,{value:s.type,options:f,onChange:m,className:"w-full"})}),e.jsx("div",{className:"p-2 pt-1",children:o.length>0?e.jsx(ye,{rounds:o,readOnly:r,bracket:s}):u?e.jsx(C,{className:"h-6"}):e.jsx(R,{text:"No rounds",className:"h-6"})}),!r&&e.jsx("div",{className:"self-end p-2 pt-0",children:e.jsx(Dt,{bracket:s})})]})})]})}we.defaultProps={className:""};function we({brackets:s,className:t,readOnly:n}){return e.jsx("div",{className:`flex flex-col space-y-1 ${t}`,children:s.map(a=>e.jsx(ve,{bracket:a,readOnly:n},a.id))})}function Et({tournament:s}){const[t,n]=d.useState(g.Elimination),a=j.useRxCollection("brackets");function r(o){const u=o[0];Object.values(g).includes(u)&&n(u)}async function l(){if(a==null)return;const o=await a.insert({id:v(),name:"",type:t,rounds:[]});s.incrementalPatch({brackets:[...s.brackets,o.id]})}const c=d.useMemo(()=>Object.values(g).map(o=>[o,F(o)]),[]);return e.jsxs("div",{className:"flex h-8  items-center space-x-1",children:[e.jsx(E,{onChange:r,options:c,value:t,className:"w-full"}),e.jsx("div",{className:"flex h-full items-center",children:e.jsx(D,{title:"Add bracket to tournament",onClick:l})})]})}Ce.defaultProps={className:""};function Ce({tournament:s,showBrackets:t,readOnly:n,className:a,showEditButton:r}){const[l,c]=w(n??!0),[o,u]=w(t??!1),[i,x]=me(s.brackets);function m(f){s.incrementalPatch({name:f})}return e.jsxs(y,{className:`bg-100 ${a}`,children:[e.jsx(p,{name:"header",children:e.jsxs("div",{className:"flex h-full w-full items-center space-x-1 p-1",children:[l?e.jsx("span",{className:"w-full truncate px-2 font-bold",children:s.name}):e.jsx(S,{value:s.name,placeholder:"Name...",onChange:m,className:"w-full font-bold"}),e.jsxs("div",{className:"flex h-full space-x-1",children:[!l&&e.jsx(P,{document:s,title:"Remove tournament"}),r&&e.jsx(I,{editModeOff:l,onChange:c,title:"Toggle tournament edit mode"}),e.jsx(T,{open:o,onChange:u,title:"Toggle show tournament brackets"})]})]})}),e.jsx(p,{name:"content",children:e.jsxs(A,{open:o,children:[e.jsx("div",{className:"p-2 pt-1",children:i.length>0?e.jsx(we,{brackets:i,readOnly:l}):x?e.jsx(C,{className:"h-6"}):e.jsx(R,{text:"No brackets",className:"h-6"})}),!l&&e.jsx("div",{className:"p-2 pt-0",children:e.jsx(Et,{tournament:s})})]})})]})}Te.defaultProps={className:""};function Te({tournaments:s,className:t,readOnly:n,showEditButton:a,showBrackets:r}){return e.jsx("div",{className:`flex flex-col space-y-1 ${t}`,children:s.map(l=>e.jsx(Ce,{tournament:l,readOnly:n,showEditButton:a,showBrackets:r},l.id))})}function Ft(){const s=j.useRxCollection("tournaments");function t(){s==null||s.insert({id:v(),name:"New Tournament",brackets:[]})}return e.jsx(D,{title:"Add new tournament",onClick:t})}function Lt(){const[s,t]=d.useState(!0),[n,a]=d.useState(!1),{result:r,isFetching:l}=j.useRxData("tournaments",c=>c.find({index:["createdAt"]}));return e.jsxs(y,{children:[e.jsx(p,{name:"header",children:e.jsxs("div",{className:"flex h-full w-full items-center justify-between p-1",children:[e.jsx("span",{className:"px-2 font-bold",children:"Tournaments"}),e.jsxs("div",{className:"flex h-full flex-row items-center space-x-1",children:[e.jsx(I,{editModeOff:s,onChange:t,title:"Toggle edit mode all tournaments"}),e.jsx(T,{open:n,onChange:a,title:"Toggle show all tournament brackets"}),e.jsx(Ft,{})]})]})}),e.jsx(p,{name:"content",children:e.jsx("div",{className:"p-3 pt-2",children:r.length>0?e.jsx(Te,{tournaments:r,showEditButton:!0,readOnly:s,showBrackets:n}):l?e.jsx(C,{className:"h-6"}):e.jsx(R,{text:"No tournaments",className:"h-6"})})})]})}ke.defaultProps={className:""};function ke({className:s}){return e.jsxs("div",{className:`grid w-full grid-cols-1 gap-4 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 2xl:grid-cols-5 ${s}`,children:[e.jsx(pt,{}),e.jsx(Mt,{}),e.jsx(It,{}),e.jsx(Lt,{})]})}Re.defaultProps={className:""};function Re({teamStats:s,name:t,className:n}){const[a]=U(Object.keys(s)),r=Tt(a),l=d.useMemo(()=>Object.keys(s).sort((c,o)=>s[o].points()-s[c].points()),[s]);return e.jsxs(y,{className:`bg-100 ${n}`,children:[e.jsx(p,{name:"header",children:e.jsx("div",{className:"flex h-full w-full items-center justify-center p-1",children:e.jsxs("span",{className:"px-2 font-bold",children:[t," Stats"]})})}),e.jsx(p,{name:"content",children:e.jsx("div",{className:"p-3 pt-2",children:l.length==0?e.jsx(R,{text:"No stats found",className:"h-8"}):e.jsxs("table",{className:"w-full table-fixed border-separate border-spacing-1",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"h-10",children:[e.jsx("th",{className:"w-1/3 text-left",children:"Team"}),e.jsx("th",{className:"rounded-3xl bg-green-300 text-green-800",children:"W"}),e.jsx("th",{className:"rounded-3xl bg-red-200 text-red-800",children:"L"}),e.jsx("th",{className:"rounded-3xl bg-sky-200 text-sky-800",children:"D"}),e.jsx("th",{children:"P"}),e.jsx("th",{className:"rounded-3xl bg-yellow-200 text-yellow-800",children:"Pts"})]})}),e.jsx("tbody",{children:l.map(c=>e.jsxs("tr",{className:"text-center",children:[e.jsx("td",{className:"truncate text-left",children:r[c]}),e.jsx("td",{className:"text-green-800",children:s[c].wins}),e.jsx("td",{className:"text-red-800",children:s[c].loses}),e.jsx("td",{className:"text-sky-800",children:s[c].draws}),e.jsx("td",{children:s[c].gamesPlayed()}),e.jsx("td",{className:"text-yellow-800",children:s[c].points()})]},c))})]})})})]})}$e.defaultProps={className:""};function $e({tournament:s,className:t}){const[n]=me(s.brackets),[a]=fe(n.map(c=>c.rounds).flat()),[r]=xe(a.map(c=>c.games).flat()),l=$t(r);return e.jsx(Re,{name:s.name,teamStats:l,className:t})}Se.defaultProps={className:""};function Se({className:s}){const[t,n]=d.useState(["",""]),{result:a}=j.useRxData("tournaments",c=>c.find({index:["createdAt"]})),r=d.useMemo(()=>a.map(c=>[c.id,c.name]),[a]),l=d.useMemo(()=>a.find(c=>c.id==t[0]),[a,t]);return!l&&t[0]!=""&&n(["",""]),e.jsxs("div",{className:`flex w-full flex-col items-center justify-center space-y-4 ${s}`,children:[e.jsx(E,{onChange:n,options:r,value:t[0],className:"w-full text-violet-800 md:w-96"}),l&&e.jsx($e,{tournament:l,className:""})]})}q.defaultProps={visible:!0};function q({visible:s,children:t}){return e.jsx("div",{className:`flex w-full justify-center transition-opacity duration-300 ease-in-out ${s?"relative opacity-100":"pointer-events-none absolute left-0 top-0 opacity-0"}`,children:t})}function Gt(){return e.jsx("footer",{className:"bg-500 relative flex w-full items-center justify-center p-4 text-violet-800",children:e.jsx("a",{href:"https://github.com/FearIndigo/react-tournament-app",title:"Tournament App Github",target:"_blank",rel:"noreferrer",className:"button bg-300",children:"View Source Code"})})}function qt(){const[s,t]=d.useState(0);return e.jsxs("div",{className:"bg-500 relative flex min-h-screen flex-col justify-between space-y-8 overflow-hidden",children:[e.jsx("div",{className:"fixed left-0 top-0 h-screen w-full bg-repeat opacity-[0.1]",style:{backgroundImage:"url(/topography.svg)"}}),e.jsxs("main",{className:"relative flex flex-col items-center space-y-8",children:[e.jsxs("div",{className:"flex flex-col items-center justify-center space-y-2 px-8 py-16 text-center text-violet-100",children:[e.jsx(te,{className:"h-16 w-16"}),e.jsx("h1",{className:"text-5xl font-bold",children:"Tournament App"}),e.jsxs("span",{children:["By ",e.jsx("a",{href:"https://joemccleery.com.au",title:"Joseph McCleery Website",target:"_blank",rel:"noreferrer",children:"Joseph McCleery"})]})]}),e.jsx("div",{className:"container w-full px-4 md:w-auto",children:e.jsx(ct,{tabs:["Creator","Data","Layout","Stats"],defaultTabIndex:s,onChanged:t})}),e.jsx("div",{className:"container w-full px-4",children:e.jsxs("div",{className:"relative w-full",children:[e.jsx(q,{visible:s==0,children:e.jsx(xt,{})}),e.jsx(q,{visible:s==1,children:e.jsx(ke,{})}),e.jsx(q,{visible:s==3,children:e.jsx(Se,{})})]})})]}),e.jsx(Gt,{})]})}let ee=!1;const Vt=()=>{const[s,t]=d.useState();return d.useEffect(()=>{ee||(ee=!0,lt().then(t))},[]),e.jsx(j.Provider,{db:s,children:e.jsx(qt,{})})};_e.createRoot(document.getElementById("root")).render(e.jsx(ze.StrictMode,{children:e.jsx(Vt,{})}));
